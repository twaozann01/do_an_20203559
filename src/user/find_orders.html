<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="/public/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/public/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="../assets/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="../assets/plugins/fontawesome/css/all.min.css">

    <!-- Feathericon CSS -->
    <link rel="stylesheet" href="../assets/css/feathericon.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/feather-icons@4.29.1/dist/feather.min.css">


    <!-- Datepicker CSS -->
    <link rel="stylesheet" href="../assets/css/bootstrap-datetimepicker.min.css">

    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="../assets/css/owl.carousel.min.css">

    <!-- Animation CSS -->
    <link rel="stylesheet" href="../assets/css/aos.css">
    <!-- Main CSS -->

    <link rel="stylesheet" href="../assets/css/css/custom.css">
    <title>Home Service</title>
</head>

<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="">
        <!-- Main Wrapper -->
        <div class="main-wrapper">

            <!-- Header -->
            <header class="header header-custom header-fixed header-one">
                <div class="container">
                    <nav class="navbar navbar-expand-lg header-nav">
                        <div class="navbar-header">
                            <a id="mobile_btn" href="javascript:void(0);">
                                <span class="bar-icon">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </span>
                            </a>
                            <a href="/public/html/index.html" class="navbar-brand logo">
                                <img src="/public/logo.png" class="img-fluid" alt="Logo">
                            </a>
                        </div>
                        <div class="main-menu-wrapper">
                            <div class="menu-header">
                                <a href="/public/html/index.html" class="menu-logo">
                                    <img src="/public/logo-removebg.png" class="img-fluid" alt="Logo">
                                </a>
                                <a id="menu_close" class="menu-close" href="javascript:void(0);">
                                    <i class="fas fa-times"></i>
                                </a>
                            </div>
                            <ul class="main-nav">
                                <li class="has-submenu megamenu">
                                    <a href="./home.html">Trang chủ </a>
                                </li>
                                <li class="has-submenu">
                                    <a href="./services.html">Dịch vụ </a>
                                </li>
                                <li class="has-submenu active">
                                    <a href="#">Đơn hàng<i class="fas fa-chevron-down"></i></a>
                                    <ul class="submenu">
                                        <li><a href="./book_orders.html">Đặt lịch sửa chữa</a></li>
                                        <li><a href="./find_orders.html">Quản lí đơn hàng</a></li>
                                        <li><a href="./chat.html">Chat</a></li>
                                    </ul>
                                </li>
                                <li class="has-submenu">
                                    <a href="/public/html/NoFound.html">Blog <i class="fas fa-chevron-down"></i></a>
                                    <ul class="submenu">
                                        <li><a href="./create_blog.html">Đăng bài</a></li>
                                        <li><a href="./blog_new.html">Bài viết mới</a></li>
                                    </ul>
                                </li>
                                <li class="has-submenu">
                                    <a href="./support.html">Hỗ trợ </a>
                                </li>
                                <li class="searchbar">
                                    <a href="#"><i class="fas fa-search"></i></a>
                                    <div class="togglesearch">
                                        <form action="./search.html">
                                            <div class="input-group">
                                                <input type="text" class="form-control">
                                                <button type="submit" class="btn">Search</button>
                                            </div>
                                        </form>
                                    </div>
                                </li>
                                <li class="login-link"><a href="./login.html"> Đăng nhập / Đăng kí</a></li>
                                <li class="register-btn">
                                    <a href="./register.html" class="btn reg-btn"><i class="feather-user"></i>Đăng
                                        kí</a>
                                </li>
                                <li class="register-btn">
                                    <a href="./login.html" class="btn btn-primary log-btn"><i
                                            class="feather-lock"></i>Đăng nhập</a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </header>
            <!-- /Header -->
            <!-- Breadcrumb -->
            <div class="breadcrumb-bar-two">
                <div class="container">
                    <div class="row align-items-center inner-banner">
                        <div class="col-md-12 col-12 text-center">
                            <h2 class="breadcrumb-title">Tìm đơn</h2>
                            <nav aria-label="breadcrumb" class="page-breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="index.html">Trang chủ</a></li>
                                    <li class="breadcrumb-item" aria-current="page">Tìm đơn</li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /Breadcrumb -->
            <!-- Page Content -->
            <div class="content">
                <!-- Find Orders -->
                <div class="find-orders">
                    <div class="container">
                        <!-- Main Content -->
                        <div class="container my-4">
                            <div class="row">
                                <div class="col-lg-4 mb-4">
                                    <div class="card shadow-sm mb-4">
                                        <div class="card-body text-center">
                                            <img src="https://randomuser.me/api/portraits/men/32.jpg"
                                                class="worker-avatar mb-3" alt="Avatar">
                                            <h4 class="mb-1">Nguyễn Văn Thợ</h4>
                                            <div class="rating-stars mb-2">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star-half-alt"></i>
                                                <span class="text-muted ms-1">4.7 (128 đánh giá)</span>
                                            </div>
                                            <div class="d-flex justify-content-center mb-3">
                                                <div class="px-3 text-center">
                                                    <div class="h5 mb-0">245</div>
                                                    <small class="text-muted">Đơn hoàn thành</small>
                                                </div>
                                                <div class="px-3 text-center">
                                                    <div class="h5 mb-0">92%</div>
                                                    <small class="text-muted">Hài lòng</small>
                                                </div>
                                            </div>

                                            <div class="d-flex align-items-center justify-content-center mb-3">
                                                <span class="me-2">Trạng thái:</span>
                                                <label class="toggle-switch">
                                                    <input type="checkbox" id="workStatusToggle" checked>
                                                    <span class="slider"></span>
                                                </label>
                                                <span class="ms-2 text-success" id="statusText">Đang hoạt động</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card shadow-sm">
                                        <div class="card-header bg-white">
                                            <h5 class="mb-0"><i class="fas fa-list me-2"></i>Dịch vụ của tôi</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-2"><i class="fas fa-bolt text-warning me-2"></i> Sửa chữa
                                                điện gia dụng</div>
                                            <div class="mb-2"><i class="fas fa-faucet text-info me-2"></i> Sửa chữa
                                                đường ống nước</div>
                                            <div class="mb-2"><i class="fas fa-door-open text-secondary me-2"></i> Sửa
                                                chữa cửa, khóa</div>
                                            <div class="mb-2"><i class="fas fa-wind text-primary me-2"></i> Bảo dưỡng
                                                điều hòa</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-8 position-relative">
                                    <div id="offlineOverlay" class="offline-overlay" style="display: none;">
                                        <div class="offline-message">
                                            <i class="fas fa-power-off text-danger me-3"></i>
                                            <p>Bạn đang ở trạng thái ngừng hoạt động.<br>
                                                Bật trạng thái để nhận đơn hàng mới.</p>
                                        </div>
                                    </div>
                                    <nav
                                        class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm header-find-orders">
                                        <div class="container">
                                            <a class="navbar-brand" href="#">
                                                <i class="fas fa-hammer me-2"></i>Home Service
                                            </a>
                                            <div class="d-flex align-items-center">
                                                <span class="text-light me-3 d-none d-md-block">Xin chào, <strong>Nguyễn
                                                        Văn
                                                        Thợ</strong></span>
                                                <img src="https://randomuser.me/api/portraits/men/32.jpg"
                                                    class="worker-avatar" alt="Avatar">
                                            </div>
                                        </div>
                                    </nav>
                                    <div class="card shadow-sm mb-4">
                                        <div
                                            class="card-header bg-white d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0"><i class="fas fa-map-marked-alt me-2"></i>Khu vực hoạt động
                                            </h5>
                                            <button class="btn btn-sm btn-outline-primary" id="filterBtn">
                                                <i class="fas fa-sliders-h me-1"></i>Bộ lọc
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div id="map"></div>
                                            <div class="mt-3 d-flex justify-content-between">
                                                <small class="text-muted"><i
                                                        class="fas fa-map-marker-alt text-danger me-1"></i> Bán kính:
                                                    <span id="radiusText">5</span>km</small>
                                                <small class="text-muted"><i class="fas fa-clock text-primary me-1"></i>
                                                    Cập nhật: <span id="lastUpdate">1 phút trước</span></small>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="filterPanel" class="card shadow-sm mb-4" style="display: none;">
                                        <div class="card-header bg-white">
                                            <h5 class="mb-0"><i class="fas fa-filter me-2"></i>Bộ lọc đơn hàng</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="mb-3">
                                                <label class="form-label">Loại dịch vụ</label>
                                                <div class="d-flex flex-wrap">
                                                    <div class="form-check me-3 mb-2">
                                                        <input class="form-check-input service-filter" type="checkbox"
                                                            id="filterAll" checked>
                                                        <label class="form-check-label" for="filterAll">Tất cả</label>
                                                    </div>
                                                    <div class="form-check me-3 mb-2">
                                                        <input class="form-check-input service-filter" type="checkbox"
                                                            id="filterElectrical" checked>
                                                        <label class="form-check-label"
                                                            for="filterElectrical">Điện</label>
                                                    </div>
                                                    <div class="form-check me-3 mb-2">
                                                        <input class="form-check-input service-filter" type="checkbox"
                                                            id="filterPlumbing" checked>
                                                        <label class="form-check-label"
                                                            for="filterPlumbing">Nước</label>
                                                    </div>
                                                    <div class="form-check me-3 mb-2">
                                                        <input class="form-check-input service-filter" type="checkbox"
                                                            id="filterAC" checked>
                                                        <label class="form-check-label" for="filterAC">Điều hòa</label>
                                                    </div>
                                                    <div class="form-check me-3 mb-2">
                                                        <input class="form-check-input service-filter" type="checkbox"
                                                            id="filterDoor" checked>
                                                        <label class="form-check-label"
                                                            for="filterDoor">Cửa/Khóa</label>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="mb-3">
                                                <label for="distanceFilter" class="form-label">Khoảng cách tối
                                                    đa</label>
                                                <select class="form-select" id="distanceFilter">
                                                    <option value="3">3 km</option>
                                                    <option value="5" selected>5 km</option>
                                                    <option value="10">10 km</option>
                                                    <option value="15">15 km</option>
                                                </select>
                                            </div>

                                            <div class="mb-3">
                                                <label for="priceFilter" class="form-label">Mức giá</label>
                                                <select class="form-select" id="priceFilter">
                                                    <option value="all">Tất cả</option>
                                                    <option value="100">Từ 100.000đ</option>
                                                    <option value="200">Từ 200.000đ</option>
                                                    <option value="500">Từ 500.000đ</option>
                                                </select>
                                            </div>

                                            <div class="d-grid gap-2">
                                                <button class="btn btn-primary" id="applyFilterBtn">Áp dụng bộ
                                                    lọc</button>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card shadow-sm">
                                        <div
                                            class="card-header bg-white d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0"><i class="fas fa-list-ol me-2"></i>Đơn hàng phù hợp</h5>
                                            <span class="badge bg-primary rounded-pill" id="orderCount">5 đơn</span>
                                        </div>
                                        <div class="card-body">
                                            <div id="ordersList">
                                                <div class="card order-card mb-3" data-id="DH001">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-start">
                                                            <div>
                                                                <h5 class="card-title mb-1">Sửa chập điện nhà tắm</h5>
                                                                <span class="badge bg-warning service-badge">
                                                                    <i class="fas fa-bolt me-1"></i>Điện
                                                                </span>
                                                                <span
                                                                    class="badge bg-danger urgent-badge service-badge">
                                                                    <i class="fas fa-exclamation-circle me-1"></i>Gấp
                                                                </span>
                                                                <div class="mt-2">
                                                                    <small class="text-muted"><i
                                                                            class="fas fa-map-marker-alt text-danger me-1"></i>
                                                                        Q.7 - Cách
                                                                        1.2km</small>
                                                                </div>
                                                            </div>
                                                            <div class="text-end">
                                                                <div class="text-primary fw-bold">250.000đ</div>
                                                                <small class="text-muted">~15 phút</small>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="mt-3 d-flex justify-content-between align-items-center">
                                                            <small class="text-muted"><i class="far fa-clock me-1"></i>
                                                                10 phút
                                                                trước</small>
                                                            <div class="text-end mt-2">
                                                                <button
                                                                    class="btn btn-sm btn-outline-primary view-detail-btn"
                                                                    data-id="${order.id}">
                                                                    <i class="fas fa-eye"></i> Xem chi tiết
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="card order-card mb-3" data-id="DH002">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-start">
                                                            <div>
                                                                <h5 class="card-title mb-1">Thay van nước toilet</h5>
                                                                <span class="badge bg-info service-badge">
                                                                    <i class="fas fa-faucet me-1"></i>Nước
                                                                </span>
                                                                <div class="mt-2">
                                                                    <small class="text-muted"><i
                                                                            class="fas fa-map-marker-alt text-danger me-1"></i>
                                                                        Q.9 - Cách
                                                                        0.8km</small>
                                                                </div>
                                                            </div>
                                                            <div class="text-end">
                                                                <div class="text-primary fw-bold">180.000đ</div>
                                                                <small class="text-muted">~10 phút</small>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="mt-3 d-flex justify-content-between align-items-center">
                                                            <small class="text-muted"><i class="far fa-clock me-1"></i>
                                                                25 phút
                                                                trước</small>
                                                            <div class="text-end mt-2">
                                                                <button
                                                                    class="btn btn-sm btn-outline-primary view-detail-btn"
                                                                    data-id="${order.id}">
                                                                    <i class="fas fa-eye"></i> Xem chi tiết
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="text-center mt-3">
                                                <button class="btn btn-outline-primary" id="loadMoreBtn">
                                                    <i class="fas fa-sync-alt me-2"></i>Tải thêm đơn hàng
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Find Orders -->
            </div>
            <!-- /Page Content -->

            <!-- Footer -->
            <footer class="footer footer-one">
                <div class="footer-top aos" data-aos="fade-up">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-9">
                                <div class="row container-item">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="footer-widget footer-about">
                                            <div class="footer-logo">
                                                <a href="./home.html"><img src="/public/logo.png" alt="logo"></a>
                                            </div>
                                            <div class="footer-about-content">
                                                <p>Dịch vụ sửa chữa tận nơi chuyên nghiệp - Nhanh chóng, uy tín, giá cả
                                                    hợp
                                                    lý, đảm bảo chất lượng với đội ngũ kỹ thuật viên giàu kinh nghiệm!
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="row container-item">
                                            <div class="col-lg-6 col-md-6">
                                                <div class="footer-widget footer-menu">
                                                    <h2 class="footer-title">Đối với khách hàng</h2>
                                                    <ul>
                                                        <li><a href="./login.html">Đăng nhập</a></li>
                                                        <li><a href="./register.html">Đăng kí</a></li>
                                                        <li><a href="./book_orders.html">Đặt lịch sửa chữa</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="col-lg-6 col-md-6">
                                                <div class="footer-widget footer-menu">
                                                    <h2 class="footer-title">Đối với KTV</h2>
                                                    <ul>
                                                        <li><a href="./login.html">Đăng nhập</a></li>
                                                        <li><a href="./find_orders.html">Quản lý đơn hàng</a></li>
                                                        <li><a href="./find_orders.html">Quản lý doanh thu</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-12">
                                        <div class="footer-widget footer-contact">
                                            <h2 class="footer-title">Liên hệ với chúng tôi</h2>
                                            <div class="footer-contact-info">
                                                <div class="footer-address">
                                                    <p><i class="fas fa-map-marker-alt"></i>Trương Định, Hoàng Mai, Hà
                                                        Nội</p>
                                                </div>
                                                <div class="footer-address">
                                                    <p><i class="fas fa-phone"></i>+84 36 346 8723</p>
                                                </div>
                                                <div class="footer-address mb-0">
                                                    <p><i class="fas fa-mail-bulk"></i>son.hv203559@sis.hust.edu.vn</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-12">
                                        <div class="footer-widget">
                                            <h2 class="footer-title">Nhận thông báo của chúng tôi</h2>
                                            <div class="subscribe-form">
                                                <form action="#">
                                                    <input type="email" class="form-control"
                                                        placeholder="Nhập địa chỉ email của bạn">
                                                    <button type="submit" class="btn">Gửi</button>
                                                </form>
                                            </div>
                                            <div class="social-icon">
                                                <ul>
                                                    <li>
                                                        <a href="javascript:void(0);"><i
                                                                class="fab fa-facebook"></i></a>
                                                    </li>
                                                    <li>
                                                        <a href="javascript:void(0);"><i
                                                                class="fab fa-instagram"></i></a>
                                                    </li>
                                                    <li>
                                                        <a href="javascript:void(0);"><i class="fab fa-twitter"></i></a>
                                                    </li>
                                                    <li>
                                                        <a href="javascript:void(0);"><i
                                                                class="fab fa-linkedin-in"></i></a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-3">
                                <div class="footer-widget footer-scope">
                                    <h2 class="footer-title">Phạm vi hoạt động</h2>
                                    <div class="footer-scope-img">
                                        <img class="img-fluid" src="/src/assets/img/banner/footer-img.png"
                                            alt="Scope-image">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <div class="container">
                        <!-- Copyright -->
                        <div class="copyright">
                            <div class="row ">
                                <div class="col-md-6 col-lg-6">
                                    <div class="copyright-text">
                                        <p class="mb-0"> Bản quyền © 2025 <a
                                                href="https://themeforest.net/user/dreamstechnologies/portfolio"
                                                target="_blank">ET4900.</a> Mọi quyền được bảo lưu.</p>
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-6">

                                    <!-- Copyright Menu -->
                                    <div class="copyright-menu">
                                        <ul class="policy-menu">
                                            <li><a href="privacy-policy.html">Chính sách bảo mật</a></li>
                                            <li><a href="terms-condition.html">Điều khoản và Dịch vụ</a></li>
                                        </ul>
                                    </div>
                                    <!-- /Copyright Menu -->

                                </div>
                            </div>
                        </div>
                        <!-- /Copyright -->
                    </div>
                </div>
            </footer>
            <!-- /Footer -->
        </div>
        <!-- Order Detail Modal -->
                        <div class="modal fade" id="orderDetailModal" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Chi tiết đơn hàng <span id="orderIdBadge"
                                                class="badge bg-secondary"></span>
                                        </h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body" id="orderDetailBody">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary"
                                            data-bs-dismiss="modal">Đóng</button>
                                        <button type="button" class="btn btn-primary" id="acceptOrderBtn">Nhận đơn
                                            ngay</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Order Accepted Modal -->
                        <div class="modal fade" id="orderAcceptedModal" tabindex="-1" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title"><i class="fas fa-check-circle me-2"></i>Đã nhận đơn
                                            thành công</h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                            aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body" id="orderAcceptedBody">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-success" id="contactCustomerBtn">
                                            <i class="fas fa-phone me-2"></i>Gọi cho khách
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary"
                                            data-bs-dismiss="modal">Đóng</button>
                                    </div>
                                </div>
                            </div>
                        </div>
        <!-- /Main Wrapper -->

        

    </div>

    <script src="../assets/js/jquery-3.7.1.min.js"></script>

    <!-- Bootstrap Core JS -->
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <!-- Feather Icon JS -->
    <script src="../assets/js/feather.min.js"></script>
    <!-- Datepicker JS -->
    <script src="../assets/js/moment.min.js"></script>
    <script src="../assets/js/bootstrap-datetimepicker.min.js"></script>
    <!-- Owl Carousel JS -->
    <script src="../assets/js/owl.carousel.min.js"></script>
    <!-- Slick JS -->
    <script src="../assets/js/slick.js"></script>
    <!-- Animation JS -->
    <script src="../assets/js/aos.js"></script>

    <!-- Counter JS -->
    <script src="../assets/js/counter.js"></script>


    <!-- Custom JS -->
    <script src="../assets/js/js/user.js"></script>
    <script>
    // Sample data - in real app this would come from API
    const sampleOrders = [
        {
            id: 'DH001',
            type: 'Điện',
            title: 'Sửa chập điện nhà tắm',
            address: '12 Nguyễn Văn Linh, Q.7, TP.HCM',
            exactAddress: 'Chung cư Sky Garden, Lầu 15, Phòng 1502',
            location: { lat: 10.8281, lng: 106.6297 },
            distance: '1.2km',
            time: '15 phút',
            price: '250.000đ',
            priceValue: 250000,
            urgent: true,
            description: 'Ổ điện trong nhà tắm bị chập, có tia lửa điện khi sử dụng. Cần thợ đến kiểm tra và sửa chữa gấp.',
            customer: 'Nguyễn Thị A',
            phone: '0987654321',
            customerNote: 'Nhà có trẻ nhỏ nên cần sửa gấp',
            createdAt: new Date(),
            preferredTime: 'Trong 2 giờ tới',
            images: []
        },
        {
            id: 'DH002',
            type: 'Nước',
            title: 'Thay van nước toilet',
            address: '45 Lê Văn Việt, Q.9, TP.HCM',
            exactAddress: 'Biệt thự số 45, hẻm 12',
            location: { lat: 10.8201, lng: 106.6357 },
            distance: '0.8km',
            time: '10 phút',
            price: '180.000đ',
            priceValue: 180000,
            urgent: false,
            description: 'Van nước toilet bị rò rỉ, cần thay mới. Đã tắt nước tổng.',
            customer: 'Trần Văn B',
            phone: '0912345678',
            customerNote: 'Có thể làm vào buổi chiều',
            createdAt: new Date(Date.now() - 25 * 60 * 1000),
            preferredTime: 'Chiều nay',
            images: []
        }
    ];

    $(document).ready(function () {
        // Global state
        const state = {
            map: null,
            markers: [],
            isActive: true,
            acceptedOrder: null
        };

        // Initialize map
        function initMap() {
            const myLocation = { lat: 10.8231, lng: 106.6297 };
            state.map = new google.maps.Map(document.getElementById("map"), {
                zoom: 14,
                center: myLocation,
                styles: [
                    {
                        featureType: "poi",
                        stylers: [{ visibility: "off" }]
                    }
                ]
            });

            new google.maps.Marker({
                position: myLocation,
                map: state.map,
                title: "Vị trí của bạn",
                icon: {
                    url: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"
                }
            });


        }

        // Trạng thái làm việc
        $('#workStatusToggle').change(function () {
            state.isActive = this.checked;
            updateUI();
        });

        // Cập nhật giao diện
        function updateUI() {
            if (state.isActive) {
                $('#statusText').text('Đang hoạt động').removeClass('text-danger').addClass('text-success');
                $('#offlineOverlay').hide();
                $('#ordersList').show();
            } else {
                $('#statusText').text('Ngừng hoạt động').removeClass('text-success').addClass('text-danger');
                $('#offlineOverlay').show();
                $('#ordersList').hide();
            }
        }

        // Bộ lọc đơn hàng
        $('#filterBtn').click(function () {
            $('#filterPanel').slideToggle();
        });

        // ÁP dụng bộ lọc
        $('#applyFilterBtn').click(function () {
            const distance = $('#distanceFilter').val();
            $('#radiusText').text(distance);
            $('#filterPanel').slideUp();
        });

        // Checkbox tất cả dịch vụ
        $('#filterAll').change(function () {
            $('.service-filter').prop('checked', this.checked);
        });

        // Checkbox dịch vụ riêng lẻ
        $('.service-filter').not('#filterAll').change(function () {
            if (!$('.service-filter:checked').not('#filterAll').length) {
                $('#filterAll').prop('checked', false);
            } else if ($('.service-filter:checked').not('#filterAll').length === $('.service-filter').not('#filterAll').length) {
                $('#filterAll').prop('checked', true);
            }
        });

        // Click để xem chi tiết đơn hàng
        $(document).on('click', '.order-card', function () {
            const orderId = $(this).data('id');
            const order = sampleOrders.find(o => o.id === orderId);

            if (order) {
                $('#orderIdBadge').text(order.id);

                const detailContent = `
                    <div class="mb-3">
                        <h5>${escapeHtml(order.title)}</h5>
                        <div class="d-flex flex-wrap mb-2">
                            <span class="badge ${order.type === 'Điện' ? 'bg-warning' : 'bg-info'} me-2 mb-2">
                                <i class="fas ${order.type === 'Điện' ? 'fa-bolt' : 'fa-faucet'} me-1"></i>${escapeHtml(order.type)}
                            </span>
                            ${order.urgent ? '<span class="badge bg-danger me-2 mb-2"><i class="fas fa-exclamation-circle me-1"></i>Ưu tiên gấp</span>' : ''}
                            <span class="badge bg-primary me-2 mb-2">${escapeHtml(order.price)}</span>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <h6><i class="fas fa-info-circle me-2"></i>Mô tả công việc</h6>
                        <p>${escapeHtml(order.description)}</p>
                        ${order.customerNote ? `<p class="text-muted"><i class="fas fa-comment-dots me-2"></i><em>${escapeHtml(order.customerNote)}</em></p>` : ''}
                    </div>
                    
                    <div class="mb-3 position-relative">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6><i class="fas fa-user me-2"></i>Thông tin khách hàng</h6>
                        </div>
                        <div class="protected-info blur-content bg-light p-2 rounded">
                            <div class="customer-info">
                                <span class="visible-part">${getPartialName(order.customer)}</span>
                                <span class="invisible-part">${getHiddenPart(order.customer)}</span>
                            </div>
                            <div class="customer-phone mt-2">
                                <span class="visible-part">${getPartialPhone(order.phone)}</span>
                                <span class="invisible-part">${getHiddenPart(order.phone)}</span>    
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <h6><i class="fas fa-map-marker-alt me-2"></i>Địa chỉ</h6>
                        <div class="protected-info bg-light p-2 rounded">
                            <div class="customer-address">
                                <span class="visible-part">${getPartialAddress(order.address)}</span>
                                <span class="invisible-part">${getHiddenPart(order.address)}</span>
                            </div>
                        </div>
                        <small class="text-muted">Cách ${order.distance} • Khoảng ${order.time} di chuyển</small>
                    </div>
                    
                    <div class="mb-3">
                        <h6><i class="fas fa-clock me-2"></i>Thời gian mong muốn</h6>
                        <p>${escapeHtml(order.preferredTime)}</p>
                    </div>
                    
                    <div class="alert alert-warning">
                        <i class="fas fa-shield-alt me-2"></i> Thông tin khách hàng chỉ hiển thị sau khi bạn nhận đơn
                    </div>
                `;

                $('#orderDetailBody').html(detailContent);
                $('#orderDetailModal').modal('show');

                // Disable accept button if not active
                $('#acceptOrderBtn').prop('disabled', !state.isActive);
            }
        });

        // Accept order
        $('#acceptOrderBtn').click(function () {
            if (!state.isActive) {
                alert('Vui lòng bật trạng thái hoạt động để nhận đơn');
                return;
            }

            const orderId = $('#orderIdBadge').text();
            const order = sampleOrders.find(o => o.id === orderId);

            if (order && confirm(`Bạn chắc chắn muốn nhận đơn "${order.title}"?`)) {
                // In real app, call API to accept order
                setTimeout(() => {
                    // Simulate API success
                    showAcceptedOrderDetails(order);
                }, 800);
            }
        });

        function showAcceptedOrderDetails(order) {
            $('#orderDetailModal').modal('hide');
            state.acceptedOrder = order;

            const acceptedContent = `
                <div class="mb-3">
                    <h5>${escapeHtml(order.title)}</h5>
                    <div class="d-flex flex-wrap mb-2">
                        <span class="badge ${order.type === 'Điện' ? 'bg-warning' : 'bg-info'} me-2 mb-2">
                            <i class="fas ${order.type === 'Điện' ? 'fa-bolt' : 'fa-faucet'} me-1"></i>${escapeHtml(order.type)}
                        </span>
                        <span class="badge bg-primary me-2 mb-2">${escapeHtml(order.price)}</span>
                        <span class="badge bg-success me-2 mb-2">Đã nhận</span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6><i class="fas fa-info-circle me-2"></i>Mô tả chi tiết</h6>
                    <p>${escapeHtml(order.description)}</p>
                    ${order.customerNote ? `<p class="text-muted"><i class="fas fa-comment-dots me-2"></i><em>${escapeHtml(order.customerNote)}</em></p>` : ''}
                </div>
                
                <div class="bg-light p-3 rounded mb-3">
                    <h6><i class="fas fa-user me-2"></i>Thông tin liên hệ</h6>
                    <p><strong>Tên:</strong> ${escapeHtml(order.customer)}</p>
                    <p><strong>Điện thoại:</strong> 
                        <a href="tel:${order.phone}" class="text-decoration-none">
                            <i class="fas fa-phone me-2"></i>${formatPhone(order.phone)}
                        </a>
                    </p>
                </div>
                
                <div class="bg-light p-3 rounded mb-3">
                    <h6><i class="fas fa-map-marker-alt me-2"></i>Địa chỉ chính xác</h6>
                    <p>${escapeHtml(order.exactAddress)}</p>
                    <p class="mb-1">${escapeHtml(order.address)}</p>
                    <small class="text-muted">Cách ${order.distance} • Khoảng ${order.time} di chuyển</small>
                </div>
                
                <div class="bg-light p-3 rounded mb-3">
                    <h6><i class="fas fa-clock me-2"></i>Thời gian thực hiện</h6>
                    <p>${escapeHtml(order.preferredTime)}</p>
                    <div class="form-floating mt-2">
                        <input type="datetime-local" class="form-control" id="scheduleTime" value="${getDefaultScheduleTime()}">
                        <label for="scheduleTime">Xác nhận thời gian đến</label>
                    </div>
                </div>
                
                <div class="alert alert-success">
                    <i class="fas fa-check-circle me-2"></i> Bạn đã nhận đơn thành công. Vui lòng liên hệ với khách hàng để xác nhận.
                </div>
            `;

            $('#orderAcceptedBody').html(acceptedContent);
            $('#orderAcceptedModal').modal('show');
        }

        // Load more orders
        $('#loadMoreBtn').click(function () {
            // In real app, this would load more orders from API
            alert('Đang tải thêm đơn hàng...');
        });

        // Helper functions
        function escapeHtml(unsafe) {
            if (!unsafe) return '';
            return unsafe.toString()
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function formatPhone(phone) {
            if (!phone) return '';
            return phone.replace(/(\d{4})(\d{3})(\d{3})/, '$1.$2.$3');
        }

        function formatTimeAgo(date) {
            if (!date) return '';
            const seconds = Math.floor((new Date() - new Date(date)) / 1000);

            if (seconds < 60) return `${seconds} giây trước`;
            if (seconds < 3600) return `${Math.floor(seconds / 60)} phút trước`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} giờ trước`;
            return `${Math.floor(seconds / 86400)} ngày trước`;
        }

        function getDefaultScheduleTime() {
            const now = new Date();
            now.setHours(now.getHours() + 1);
            return now.toISOString().slice(0, 16);
        }
        function getPartialName(fullName) {
            if (!fullName) return '';
            const parts = fullName.split(' ');
            if (parts.length === 1) return parts[0];
            return parts[0];
        }

        function getPartialPhone(phone) {
            if (!phone) return '';
            return phone.substring(0, 2);
        }

        function getPartialAddress(address) {
            if (!address) return '';
            const parts = address.split(',');
            return  parts[1] + (parts.length > 1 ? ', ' + parts[2] : '');
        }

        function getHiddenPart(text) {
            if (!text) return '';
            return text.replace(/./g, '•');
        }
    });
</script>

</body>

</html>